<div class="max-w-6xl mx-auto py-8">
  <h1 class="font-bold text-4xl mb-6">Admin: Users</h1>

  <%= form_with url: admin_users_path, method: :get, class: "mb-6" do |f| %>
    <div class="flex gap-2">
      <%= f.search_field :query, value: params[:query], placeholder: "Search users...", class: "border rounded px-3 py-2 flex-1" %>
      <%= f.submit "Search", class: "bg-gray-200 px-4 py-2 rounded hover:bg-gray-300 cursor-pointer" %>
    </div>
  <% end %>

  <table class="w-full border-collapse">
    <thead>
      <tr class="border-b text-left">
        <th class="py-2 px-3">Name</th>
        <th class="py-2 px-3">Email</th>
        <th class="py-2 px-3">Roles</th>
        <th class="py-2 px-3">Projects</th>
        <th class="py-2 px-3">Joined</th>
      </tr>
    </thead>
    <tbody>
      <% @users.each do |user| %>
        <tr class="border-b hover:bg-gray-50 <%= 'opacity-50' if user.discarded? %>">
          <td class="py-2 px-3">
            <%= link_to user.display_name, admin_user_path(user), class: "text-blue-600 hover:underline" %>
            <% if user.discarded? %>
              <span class="text-xs text-red-500 ml-1">Deleted</span>
            <% end %>
          </td>
          <td class="py-2 px-3"><%= user.email %></td>
          <td class="py-2 px-3"><%= user.roles.join(", ") %></td>
          <td class="py-2 px-3"><%= user.projects.size %></td>
          <td class="py-2 px-3"><%= user.created_at.strftime("%b %d, %Y") %></td>
        </tr>
      <% end %>
    </tbody>
  </table>

  <%== pagy_nav(@pagy) %>
</div>
